---
title:  Vasp利用py脚本辅助计算费米面
tags: VASP DFT
pageview: true
layout: article
license: ture
toc: ture
key: a20210927
header:
  theme: dark
  background: 'linear-gradient(135deg, rgb(21, 81, 138), rgb(147, 15, 139))'
aside:
    toc: true
sitemap: true
mathjax: true
author: 转载
---


<div id="blog_article" class="d cl">
  <p style="text-indent:28px"><span style="font-family:宋体">如果想用</span>VASP<span style="font-family:宋体">绘费米面（</span>Fermisurface<span style="font-family:宋体">），一般都需要用</span><a href="http://wannier.org/" target="_blank" one-link-mark="yes">wannier90</a><span style="font-family:宋体">软件</span>wannier<span style="font-family:宋体">化后再计算费米面。因此需要重新编译</span>wannier90<span style="font-family:宋体">版的</span>VASP<span style="font-family:宋体">，而且有时</span>wannier90<span style="font-family:宋体">插值的能带并不正确，这将带来很大的不便。如果我们能将布里渊区所有的</span>k<span style="font-family:宋体">点都计算出来，并将本征值按照一定顺序和格式生成</span>bxsf<span style="font-family:宋体">文件（</span><a href="http://www.xcrysden.org/doc/XSF.html" target="_blank" one-link-mark="yes">http://www.xcrysden.org/doc/XSF.html</a><span style="font-family:宋体">），也可以绘制出费米面。这里编写了直接生成倒空间</span>k<span style="font-family:宋体">点并提取</span>VASP EIGENVAL<span style="font-family:宋体">文件计算费米面的脚本。</span></p>
  
<p><strong><span style="font-family:宋体;font-size:18px;">脚本和例子：</span></strong><a href="/assets/20210927/fs.zip" target="_blank" one-link-mark="yes">Fermi_Surface.rar</a>（点击下载）
  
  <span style="font-size:18px;text-decoration-line:underline;"></span></p><p><strong style="text-indent:28px;"><span style="font-family:宋体;font-size:18px;">所需程序：</span></strong><span style="text-indent:28px;font-size:18px;">VASP</span><span style="text-indent:28px;font-family:宋体;font-size:18px;">、</span><span style="text-indent:28px;font-size:18px;">python3</span><span style="text-indent:28px;font-family:宋体;font-size:18px;">、</span><span style="text-indent:28px;font-size:18px;">XCrySDen</span></p>
  
  <p><strong><span style="font-family:宋体;font-size:18px;">使用方法：</span></strong></p><p>1.<span style="font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family:宋体;">进行常规的</span>VASP<span style="font-family:宋体;">自洽计算。</span></p><p>2.<span style="font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family:宋体;">在</span>inpu.dat<span style="font-family:宋体;">中输入下面的参数：</span></p><table border="1" style="border:none"><tbody><tr class="firstRow"><td width="553" valign="top" style="width:553px;border:solid #000 1px;padding:0 7px 0 7px"><p>32 &nbsp;32 &nbsp;16</p><p>5.2288 &nbsp; 0.0 &nbsp;0.0</p><p>0.298862722 &nbsp;0.172548473 &nbsp; 0.000000000</p><p>0.000000000 &nbsp;0.345096946 &nbsp; 0.000000000</p><p>0.000000000 &nbsp;0.000000000 &nbsp; 0.164380078</p></td></tr></tbody></table><p><span style="font-family:宋体">其中，第一行的三个数值分别为</span>a<span style="font-family:宋体">、</span>b<span style="font-family:宋体">、</span>c<span style="font-family:宋体">方向</span>k<span style="font-family:宋体">点网格数目</span>nx<span style="font-family:宋体">、</span>ny<span style="font-family:宋体">、</span>nz<span style="font-family:宋体">；第二行第一个数值为费米能级，后面两了</span>0.0<span style="font-family:宋体">无意义；第三至第五行为倒空间矢量（在</span>OUTCAR<span style="font-family:宋体">中查找，关键字</span>“reciprocal lattice vectors”<span style="font-family:宋体">）。</span></p><p>3.<span style="font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family:宋体;">运行</span><strong>python &nbsp;Genkpoints.py </strong>（Genkpoints.py和input.dat需要在同一个文件夹）<span style="font-family:宋体;">生成</span>KPOINTS<span style="font-family:宋体;">文件，生成的</span>KPOINTS<span style="font-family:宋体;">格式如下：</span></p><table border="1" style="border:none"><tbody><tr class="firstRow"><td width="553" valign="top" style="width:553px;border:solid #000 1px;padding:0 7px 0 7px"><p>Explicit k-points list</p><p>9261</p><p>Reciprocal lattice</p><p>&nbsp; 0.000000 &nbsp;0.000000 0.000000 &nbsp;1</p><p>&nbsp; 0.000000 &nbsp;0.000000 0.050000 &nbsp;1</p><p>&nbsp; 0.000000 &nbsp;0.000000 0.100000 &nbsp;1</p><p>&nbsp; 0.000000 &nbsp;0.000000 0.150000 &nbsp;1</p><p>&nbsp;……</p></td></tr></tbody></table><p><span style="text-indent:0em;">4.</span><span style="text-indent:0em;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-indent:0em;font-family:宋体;">将生成的</span><span style="text-indent:0em;">KPOINTS</span><span style="text-indent:0em;font-family:宋体;">文件放在能带计算的</span><span style="text-indent:0em;font-family:宋体;">文件夹中进行常规能带计算。</span></p><p><span style="text-align:center;">5.</span><span style="text-align:center;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align:center;font-family:宋体;">计算结束后，将</span><span style="text-align:center;">EIGENVAL</span><span style="text-align:center;font-family:宋体;">文件拷贝到当前文件夹，然后运行</span><strong style="text-align:center;">python &nbsp;EIG2bxsf.py </strong>（EIG2bxsf.py、input.dat和<span style="text-align:center;">EIGENVAL</span>需要在同一个文件夹）<span style="text-align:center;font-family:宋体;">，得到</span><span style="text-align:center;">Python.bxsf</span><span style="text-align:center;font-family:宋体;">文件。</span></p><p>6.<span style="font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family:宋体;">将生成的</span>Python.bxsf<span style="font-family:宋体;">文件用</span>XCrySDen<span style="font-family:宋体;">打开，即可看到该材料的费米面，如下图所示。</span></p>
  
  <p style="text-align:center;page-break-after:avoid"><img src="/assets/20210927/FS.png" style="display: inline;">
    <br>
  </p><p style="text-align:center"><span style="font-family:黑体">图</span> &nbsp; MgB<sub>2</sub>(<span style="font-family:黑体">左</span>)<span style="font-family:黑体">和</span>1T-TaS<sub>2</sub>(<span style="font-family:黑体">右</span>)<span style="font-family:黑体">的费米面</span></p>
  
  <p><strong><span style="font-family:宋体;font-size:20px;">说</span></strong><strong><span style="font-size:20px;"> &nbsp;</span></strong><strong><span style="font-family:宋体;font-size:20px;">明：</span></strong></p><p>1.<span style="font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span>VASP<span style="font-family:宋体;">最多允许输入</span>20000<span style="font-family:宋体;">个</span>k<span style="font-family:宋体;">点，如果超过这个数值，则会出现如下报错：</span></p><p style="text-align:center"><span style="color:red">ERROR in RD_KPOINTS (mkpoints.F): increase NKDIMD to &nbsp; &nbsp; &nbsp; 29791</span></p><p><span style="font-family:宋体">此时需要降低</span>k<span style="font-family:宋体">点网格使</span>(nx+1)*(ny+1)*(nz+1)&lt;20000<span style="font-family:宋体">。或者修改</span>mkpoints.F<span style="font-family:宋体">文件夹下的</span>NKDIMD<span style="font-family:宋体">后重新编译</span>VASP<span style="font-family:宋体">。</span></p><p>2.<span style="font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="font-family:宋体;">如果</span>k<span style="font-family:宋体;">点太少，绘制的费米面比较粗糙，可以在</span>XCrySDen<span style="font-family:宋体;">设置费米面插值，如下图所示：</span></p>
  
  <p style="text-align:center"><img src="/assets/20210927/bar.png" style="display: inline;"></p><p style="text-align: left;"><span style="text-align:left;">3.</span><span style="text-align:left;font-variant-numeric:normal;font-variant-east-asian:normal;font-stretch:normal;font-size:9px;line-height:normal;font-family:&quot;times new roman&quot;;"> &nbsp; &nbsp; &nbsp; &nbsp;</span><span style="text-align:left;font-family:宋体;">此程序没有考虑晶体的对称性，所以生成的</span><span style="text-align:left;">k</span><span style="text-align:left;font-family:宋体;">点较多，如果考虑对称性计算量将大大降低。如果您有编程实现思路欢迎和我联系。</span></p>                    <br><br>
  
                                        <label style="font-size:13px; color:#850f0f">转载本文请联系原作者获取授权，同时请注明本文来自肖瑞春科学网博客。<br>链接地址：</label><a href="http://blog.sciencenet.cn/blog-1502061-1093325.html" target="_blank" style="font-size:13px; color:#850f0f" one-link-mark="yes">http://blog.sciencenet.cn/blog-1502061-1093325.html </a>                                     
</div>

